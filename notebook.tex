
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{Data Analysis - Experimento fr?o BAT}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \section{Introducción}\label{introducciuxf3n}

Es sabido que la obesidad es un problema alarmante en la sociedad
actual. Cada vez mas persona se vuelven obesas con sus complicaciones
secundarias, como la diabetes. Diabetes y obesidad estan muy ligadas,
teniendo un crecimiento paralelo. Una de las posibles terapias a la
obesidad es el incremento del consumo energètico a través de la
termogenesis sin vibración (??non-shivering thermogenesis??). El tejido
responsable de esta termogenesis es el tejido adiposo marrón, el BAT (de
sus siglas en inglès Brown Adipose Tissue). Uno de los activadores
conocidos de la termogenesis en humanos es la exposición al frio, que a
través del sistema nervioso central y con la ayuda del receptor
B3-adrenergico augmenta AMPc a través de PKA, afectando el factor de
transcripción CREB, augmentando PGC-1alpha y finalmente incrementando la
expressión de UCP1, la proteina responsable de la generación de calor.

Para elucidar el conocimiento que tenemos de este proceso ratones se
exponieron a 4ºC o a temperatura de termoneutralidad, 29ºC. Estos
animales despues de 24h expuestos a frio o a termoneutralidad fueron
sacrificados, el iBAT fue cogido y el RNA obtenido. Este RNA se utilizo
para hacer RNA-Seq para medir la expressión genica. Todo este trabajo
fue realizado por el grup de Francesc Villaroya y colgado en el
repositorio libre Gene Expression Omnibus (GEO) con numero de serie
``GSE77534''.

https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE77534

    \subsection{Obtención de datos}\label{obtenciuxf3n-de-datos}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        \PY{k+kn}{import} \PY{n+nn}{warnings}
        \PY{k+kn}{import} \PY{n+nn}{urllib}
        \PY{k+kn}{import} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k}{as} \PY{n+nn}{ss}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{decomposition} \PY{k}{import} \PY{n}{PCA}
        
        \PY{k+kn}{import} \PY{n+nn}{requests}
        \PY{k+kn}{import} \PY{n+nn}{os}
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{tempfile}
        
        \PY{k+kn}{from} \PY{n+nn}{plotly}\PY{n+nn}{.}\PY{n+nn}{offline} \PY{k}{import} \PY{n}{iplot}
        \PY{k+kn}{import} \PY{n+nn}{plotly}\PY{n+nn}{.}\PY{n+nn}{graph\PYZus{}objs} \PY{k}{as} \PY{n+nn}{go}
        \PY{k+kn}{from} \PY{n+nn}{plotly}\PY{n+nn}{.}\PY{n+nn}{offline} \PY{k}{import} \PY{n}{iplot}
        \PY{k+kn}{import} \PY{n+nn}{plotly}\PY{n+nn}{.}\PY{n+nn}{graph\PYZus{}objs} \PY{k}{as} \PY{n+nn}{go}
        \PY{k+kn}{from} \PY{n+nn}{IPython}\PY{n+nn}{.}\PY{n+nn}{display} \PY{k}{import} \PY{n}{display}\PY{p}{,} \PY{n}{Markdown}\PY{p}{,} \PY{n}{IFrame}
        \PY{k+kn}{from} \PY{n+nn}{plotly}\PY{n+nn}{.}\PY{n+nn}{offline} \PY{k}{import} \PY{n}{init\PYZus{}notebook\PYZus{}mode}
        
        \PY{k}{with} \PY{n}{warnings}\PY{o}{.}\PY{n}{catch\PYZus{}warnings}\PY{p}{(}\PY{p}{)}\PY{p}{:}
            \PY{n}{warnings}\PY{o}{.}\PY{n}{simplefilter}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ignore}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
            \PY{k+kn}{import} \PY{n+nn}{h5py}
            
        \PY{n}{init\PYZus{}notebook\PYZus{}mode}\PY{p}{(}\PY{p}{)}
        \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
        
        \PY{k}{def} \PY{n+nf}{archs4}\PY{p}{(}\PY{n}{gse}\PY{p}{,} \PY{n}{platform}\PY{p}{)}\PY{p}{:}
        
            \PY{c+c1}{\PYZsh{} Load HDF5 File}
            \PY{c+c1}{\PYZsh{} h5 = \PYZsq{}/Users/denis/Data/archs\PYZhy{}v1.1/h5/\PYZob{}gse\PYZcb{}\PYZhy{}\PYZob{}platform\PYZcb{}.h5\PYZsq{}.format(**locals())}
            \PY{n}{h5} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./files/}\PY{l+s+si}{\PYZob{}gse\PYZcb{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+si}{\PYZob{}platform\PYZcb{}}\PY{l+s+s1}{.h5}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{o}{*}\PY{o}{*}\PY{n+nb}{locals}\PY{p}{(}\PY{p}{)}\PY{p}{)}
            \PY{k}{with} \PY{n+nb}{open}\PY{p}{(}\PY{n}{h5}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{as} \PY{n}{openfile}\PY{p}{:}
                \PY{n}{openfile}\PY{o}{.}\PY{n}{write}\PY{p}{(}\PY{n}{urllib}\PY{o}{.}\PY{n}{request}\PY{o}{.}\PY{n}{urlopen}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{https://storage.googleapis.com/archs4\PYZhy{}packages\PYZhy{}v2/}\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n}{h5}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{read}\PY{p}{(}\PY{p}{)}\PY{p}{)}
            \PY{n}{f} \PY{o}{=} \PY{n}{h5py}\PY{o}{.}\PY{n}{File}\PY{p}{(}\PY{n}{h5}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            
            \PY{c+c1}{\PYZsh{} Get data}
            \PY{n}{rawcount\PYZus{}dataframe} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{n}{f}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{expression}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{value}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{n}{x} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{f}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{meta}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gene}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{symbol}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{value}\PY{p}{]}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{p}{[}\PY{n}{x} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{f}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{meta}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sample}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sample\PYZus{}geo\PYZus{}accession}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{value}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{T}
            \PY{n}{sample\PYZus{}metadata\PYZus{}dataframe} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{\PYZob{}}\PY{n}{key}\PY{p}{:} \PY{p}{[}\PY{n}{x} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{value}\PY{o}{.}\PY{n}{value}\PY{p}{]} \PY{k}{if} \PY{n+nb}{type}\PY{p}{(}\PY{n}{value}\PY{p}{)} \PY{o}{==} \PY{n}{h5py}\PY{o}{.}\PY{n}{\PYZus{}hl}\PY{o}{.}\PY{n}{dataset}\PY{o}{.}\PY{n}{Dataset} \PY{k}{else} \PY{p}{[}\PY{n}{x} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{p}{[}\PY{n}{y} \PY{k}{for} \PY{n}{y} \PY{o+ow}{in} \PY{n}{value}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{value}\PY{p}{]} \PY{k}{for} \PY{n}{key}\PY{p}{,} \PY{n}{value} \PY{o+ow}{in} \PY{n}{f}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{meta}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sample}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sample\PYZus{}geo\PYZus{}accession}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sample\PYZus{}title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sample Title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{)}
            \PY{c+c1}{\PYZsh{} for column in sample\PYZus{}metadata\PYZus{}dataframe.columns:}
            \PY{c+c1}{\PYZsh{} 	unique\PYZus{}vals = list(set(sample\PYZus{}metadata\PYZus{}dataframe[column]))}
            \PY{c+c1}{\PYZsh{} 	if len(unique\PYZus{}vals) == 1 or any([len(x) \PYZgt{} 20 for x in unique\PYZus{}vals]):}
        	   \PY{c+c1}{\PYZsh{}  	sample\PYZus{}metadata\PYZus{}dataframe.drop(column, axis=1, inplace=True)}
            \PY{n}{data} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rawdata}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{rawcount\PYZus{}dataframe}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sample\PYZus{}metadata}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{sample\PYZus{}metadata\PYZus{}dataframe}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dataset\PYZus{}metadata}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{source}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{archs4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{datatype}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rnaseq}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{\PYZcb{}}
            \PY{c+c1}{\PYZsh{} os.unlink(h5)}
            
            \PY{c+c1}{\PYZsh{} Return}
            \PY{k}{return} \PY{n}{data}
        
        \PY{n}{dataset} \PY{o}{=} \PY{n}{archs4}\PY{p}{(}\PY{n}{gse}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GSE77534}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{platform}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GPL13112}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} Previsualizar datos de expresión}
        \PY{n}{dataset}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rawdata}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    
    
\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}1}]:}          GSM2054036  GSM2054037  GSM2054038  GSM2054039  GSM2054040  \textbackslash{}
        A1BG              1           3           0           0           7   
        A1CF              0           0           0           0           0   
        A2M               0           0           0           0           0   
        A3GALT2           2           8           2           0           8   
        A4GALT           18          63           9           2          14   
        
                 GSM2054041  GSM2054042  GSM2054043  
        A1BG             10           3          12  
        A1CF              0           0           0  
        A2M               0           0           0  
        A3GALT2          14           8          10  
        A4GALT           53          12          30  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{c+c1}{\PYZsh{} Display metadata}
        \PY{n}{dataset}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sample\PYZus{}metadata}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}2}]:}                           Sample Title    age  \textbackslash{}
        Sample\_geo\_accession                            
        GSM2054036              cold exposed 1  adult   
        GSM2054037              cold exposed 2  adult   
        GSM2054038              cold exposed 4  adult   
        GSM2054039              cold exposed 5  adult   
        GSM2054040            thermo-neutral 1  adult   
        GSM2054041            thermo-neutral 2  adult   
        GSM2054042            thermo-neutral 4  adult   
        GSM2054043            thermo-neutral 5  adult   
        
                                                   exposed to gender  \textbackslash{}
        Sample\_geo\_accession                                           
        GSM2054036                 4C environment temperature   male   
        GSM2054037                 4C environment temperature   male   
        GSM2054038                 4C environment temperature   male   
        GSM2054039                 4C environment temperature   male   
        GSM2054040            thermoneutral temperature (29C)   male   
        GSM2054041            thermoneutral temperature (29C)   male   
        GSM2054042            thermoneutral temperature (29C)   male   
        GSM2054043            thermoneutral temperature (29C)   male   
        
                             strain background                      tissue  
        Sample\_geo\_accession                                                
        GSM2054036                      C57BL6  Brown adipose tissue (BAT)  
        GSM2054037                      C57BL6  Brown adipose tissue (BAT)  
        GSM2054038                      C57BL6  Brown adipose tissue (BAT)  
        GSM2054039                      C57BL6  Brown adipose tissue (BAT)  
        GSM2054040                      C57BL6  Brown adipose tissue (BAT)  
        GSM2054041                      C57BL6  Brown adipose tissue (BAT)  
        GSM2054042                      C57BL6  Brown adipose tissue (BAT)  
        GSM2054043                      C57BL6  Brown adipose tissue (BAT)  
\end{Verbatim}
            
    \subsection{Determinar grupos de
sujetos}\label{determinar-grupos-de-sujetos}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{n}{dataset}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{group\PYZus{}metadata}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{p}{\PYZob{}}
            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Ambiente vs Frío}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{\PYZob{}}
                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{A}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GSM2054040}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GSM2054041}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GSM2054042}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GSM2054043}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{B}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GSM2054036}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GSM2054037}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GSM2054038}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GSM2054039}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
            \PY{p}{\PYZcb{}}
        \PY{p}{\PYZcb{}}
        
        \PY{n}{group\PYZus{}A} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GSM2054040}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GSM2054041}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GSM2054042}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GSM2054043}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{n}{group\PYZus{}A\PYZus{}Label} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Ambiente}\PY{l+s+s2}{\PYZdq{}}
        \PY{n}{group\PYZus{}B} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GSM2054036}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GSM2054037}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GSM2054038}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GSM2054039}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{n}{group\PYZus{}B\PYZus{}Label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Frío}\PY{l+s+s1}{\PYZsq{}}
\end{Verbatim}


    \subsection{Normalizar datos}\label{normalizar-datos}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{c+c1}{\PYZsh{} Aplicamos algoritmo de normalización de datos encontrado en internet}
        \PY{n}{data} \PY{o}{=} \PY{n}{dataset}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rawdata}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
        \PY{n}{data} \PY{o}{=} \PY{n}{data}\PY{o}{/}\PY{n}{data}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
        \PY{n}{data} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}
        \PY{n}{data} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{log10}\PY{p}{(}\PY{n}{data}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}
        
        \PY{n}{dataset}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{logCPM}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{data}
\end{Verbatim}


    \subsection{Calcular PCA}\label{calcular-pca}

Podemos ver claramente como la exposición durante 24h a 4ºC nos produce
un efecto claro, separando las muestras expuestas a frio de las
expuestas a termoneutralidad en el eje de la componente principal 1, que
alberga el 82,58\% de varianza. La componente principal 2 alberga el
5,17\% de varinza y el componente numero 3 el 3.44\%. En total este PCA
explica el 91,2\% de tota la varianza.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{n}{expression\PYZus{}dataframe} \PY{o}{=} \PY{n}{dataset}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{logCPM}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
        \PY{n}{expression\PYZus{}dataframe}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}6}]:}            GSM2054036    GSM2054037    GSM2054038    GSM2054039    GSM2054040  \textbackslash{}
        A1BG     4.412403e-08  4.163662e-08  0.000000e+00  0.000000e+00  1.413660e-07   
        A1CF     0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00   
        A2M      0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00   
        A3GALT2  8.824805e-08  1.110310e-07  1.183801e-07  0.000000e+00  1.615611e-07   
        A4GALT   7.942318e-07  8.743682e-07  5.327100e-07  2.687421e-07  2.827320e-07   
        
                   GSM2054041    GSM2054042    GSM2054043  
        A1BG     1.476876e-07  1.124920e-07  1.779818e-07  
        A1CF     0.000000e+00  0.000000e+00  0.000000e+00  
        A2M      0.000000e+00  0.000000e+00  0.000000e+00  
        A3GALT2  2.067626e-07  2.999786e-07  1.483182e-07  
        A4GALT   7.827435e-07  4.499678e-07  4.449543e-07  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{c+c1}{\PYZsh{} Filtrar los 2500 genes con mayor varianza}
        \PY{n}{expression\PYZus{}dataframe} \PY{o}{=} \PY{n}{expression\PYZus{}dataframe}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{expression\PYZus{}dataframe}\PY{o}{.}\PY{n}{var}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{2500}\PY{p}{]}\PY{p}{]}
\end{Verbatim}


    \begin{figure}
\centering
\includegraphics{attachment:zscore.png}
\caption{zscore.png}
\end{figure}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{c+c1}{\PYZsh{} Aplicar ZSCORE para centrar los valores}
        \PY{n}{expression\PYZus{}dataframe} \PY{o}{=} \PY{n}{expression\PYZus{}dataframe}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{n}{ss}\PY{o}{.}\PY{n}{zscore}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{c+c1}{\PYZsh{} Calcular PCA}
        \PY{n}{pca}\PY{o}{=}\PY{n}{PCA}\PY{p}{(}\PY{n}{n\PYZus{}components}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}
        \PY{n}{pca}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{expression\PYZus{}dataframe}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}9}]:} PCA(copy=True, iterated\_power='auto', n\_components=3, random\_state=None,
          svd\_solver='auto', tol=0.0, whiten=False)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{n}{var\PYZus{}explained} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Componente }\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{p}{(}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{(}\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{n+nb}{round}\PY{p}{(}\PY{n}{e}\PY{o}{*}\PY{l+m+mi}{100}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{ varianza)}\PY{l+s+s1}{\PYZsq{}} \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{e} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{pca}\PY{o}{.}\PY{n}{explained\PYZus{}variance\PYZus{}ratio\PYZus{}}\PY{p}{)}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{n}{var\PYZus{}explained}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}11}]:} ['Componente 1(82.6\% varianza)',
          'Componente 2(5.2\% varianza)',
          'Componente 3(3.4\% varianza)']
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{n}{col} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{c+c1}{\PYZsh{}group\PYZus{}dict = list(dataset.get(\PYZsq{}group\PYZus{}metadata\PYZsq{}).values())[0]}
         
         \PY{k}{for} \PY{n}{gsm} \PY{o+ow}{in} \PY{n}{dataset}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sample\PYZus{}metadata}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{index}\PY{p}{:}
             \PY{k}{if} \PY{n}{gsm} \PY{o+ow}{in} \PY{n}{group\PYZus{}A}\PY{p}{:}
                 \PY{n}{col}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{group\PYZus{}A\PYZus{}Label}\PY{p}{)}
             \PY{k}{elif} \PY{n}{gsm} \PY{o+ow}{in} \PY{n}{group\PYZus{}B}\PY{p}{:}
                 \PY{n}{col}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{group\PYZus{}B\PYZus{}Label}\PY{p}{)}
             \PY{k}{else}\PY{p}{:}
                 \PY{n}{col}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Otro grupo}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                 
         \PY{n}{dataset}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sample\PYZus{}metadata}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Grupo}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{col}
         \PY{n}{color\PYZus{}by} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Grupo}\PY{l+s+s1}{\PYZsq{}}
         
         \PY{n}{dataset}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sample\PYZus{}metadata}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}12}]:}                           Sample Title    age  \textbackslash{}
         Sample\_geo\_accession                            
         GSM2054036              cold exposed 1  adult   
         GSM2054037              cold exposed 2  adult   
         GSM2054038              cold exposed 4  adult   
         GSM2054039              cold exposed 5  adult   
         GSM2054040            thermo-neutral 1  adult   
         GSM2054041            thermo-neutral 2  adult   
         GSM2054042            thermo-neutral 4  adult   
         GSM2054043            thermo-neutral 5  adult   
         
                                                    exposed to gender  \textbackslash{}
         Sample\_geo\_accession                                           
         GSM2054036                 4C environment temperature   male   
         GSM2054037                 4C environment temperature   male   
         GSM2054038                 4C environment temperature   male   
         GSM2054039                 4C environment temperature   male   
         GSM2054040            thermoneutral temperature (29C)   male   
         GSM2054041            thermoneutral temperature (29C)   male   
         GSM2054042            thermoneutral temperature (29C)   male   
         GSM2054043            thermoneutral temperature (29C)   male   
         
                              strain background                      tissue     Grupo  
         Sample\_geo\_accession                                                          
         GSM2054036                      C57BL6  Brown adipose tissue (BAT)      Frío  
         GSM2054037                      C57BL6  Brown adipose tissue (BAT)      Frío  
         GSM2054038                      C57BL6  Brown adipose tissue (BAT)      Frío  
         GSM2054039                      C57BL6  Brown adipose tissue (BAT)      Frío  
         GSM2054040                      C57BL6  Brown adipose tissue (BAT)  Ambiente  
         GSM2054041                      C57BL6  Brown adipose tissue (BAT)  Ambiente  
         GSM2054042                      C57BL6  Brown adipose tissue (BAT)  Ambiente  
         GSM2054043                      C57BL6  Brown adipose tissue (BAT)  Ambiente  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{c+c1}{\PYZsh{} Generar objeto para generación de plot}
         \PY{n}{color\PYZus{}type} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{categorical}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{color\PYZus{}column} \PY{o}{=} \PY{n}{dataset}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sample\PYZus{}metadata}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{n}{color\PYZus{}by}\PY{p}{]}
         \PY{n}{colors} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}a6cee3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}1f78b4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}b2df8a}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}33a02c}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}fb9a99}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}e31a1c}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}fdbf6f}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}ff7f00}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}cab2d6}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}6a3d9a}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}ffff99}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}b15928}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{sample\PYZus{}titles} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZlt{}b\PYZgt{}}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZlt{}/b\PYZgt{}\PYZlt{}br\PYZgt{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{index}\PY{p}{)}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZlt{}br\PYZgt{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZlt{}i\PYZgt{}}\PY{l+s+si}{\PYZob{}key\PYZcb{}}\PY{l+s+s1}{\PYZlt{}/i\PYZgt{}: }\PY{l+s+si}{\PYZob{}value\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{o}{*}\PY{o}{*}\PY{n+nb}{locals}\PY{p}{(}\PY{p}{)}\PY{p}{)} \PY{k}{for} \PY{n}{key}\PY{p}{,} \PY{n}{value} \PY{o+ow}{in} \PY{n}{rowData}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{)} \PY{k}{for} \PY{n}{index}\PY{p}{,} \PY{n}{rowData} \PY{o+ow}{in} \PY{n}{dataset}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sample\PYZus{}metadata}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{c+c1}{\PYZsh{} Get unique categories}
         \PY{n}{unique\PYZus{}categories} \PY{o}{=} \PY{n}{color\PYZus{}column}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Define empty list}
         \PY{n}{data} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{} Loop through the unique categories}
         \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{category} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{unique\PYZus{}categories}\PY{p}{)}\PY{p}{:}
         
             \PY{c+c1}{\PYZsh{} Get the color corresponding to the category}
         
             \PY{c+c1}{\PYZsh{} If signature}
             \PY{k}{if} \PY{n}{color\PYZus{}by} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sample Group}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                 \PY{n}{group\PYZus{}A}\PY{p}{,} \PY{n}{group\PYZus{}B} \PY{o}{=} \PY{p}{[}\PY{n}{x}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ vs }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{dataset}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{group\PYZus{}metadata}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                 \PY{k}{if} \PY{n}{category} \PY{o}{==} \PY{n}{group\PYZus{}A}\PY{p}{:}
                     \PY{n}{category\PYZus{}color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}
                 \PY{k}{elif} \PY{n}{category} \PY{o}{==} \PY{n}{group\PYZus{}B}\PY{p}{:}
                     \PY{n}{category\PYZus{}color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}
                 \PY{k}{else}\PY{p}{:}
                     \PY{n}{category\PYZus{}color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{black}\PY{l+s+s1}{\PYZsq{}}
             \PY{k}{else}\PY{p}{:}
                 \PY{n}{category\PYZus{}color} \PY{o}{=} \PY{n}{colors}\PY{p}{[}\PY{n}{i}\PY{p}{]}
         
             \PY{c+c1}{\PYZsh{} Get the indices of the samples corresponding to the category}
             \PY{n}{category\PYZus{}indices} \PY{o}{=} \PY{p}{[}\PY{n}{i} \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{sample\PYZus{}category} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{color\PYZus{}column}\PY{p}{)} \PY{k}{if} \PY{n}{sample\PYZus{}category} \PY{o}{==} \PY{n}{category}\PY{p}{]}
         
             \PY{c+c1}{\PYZsh{} Create new trace}
             \PY{n}{trace} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Scatter3d}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n}{pca}\PY{o}{.}\PY{n}{components\PYZus{}}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{n}{category\PYZus{}indices}\PY{p}{]}\PY{p}{,}
                                  \PY{n}{y}\PY{o}{=}\PY{n}{pca}\PY{o}{.}\PY{n}{components\PYZus{}}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{n}{category\PYZus{}indices}\PY{p}{]}\PY{p}{,}
                                  \PY{n}{z}\PY{o}{=}\PY{n}{pca}\PY{o}{.}\PY{n}{components\PYZus{}}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{[}\PY{n}{category\PYZus{}indices}\PY{p}{]}\PY{p}{,}
                                  \PY{n}{mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{markers}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                  \PY{n}{hoverinfo}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                                  \PY{n}{text}\PY{o}{=}\PY{p}{[}\PY{n}{sample\PYZus{}titles}\PY{p}{[}\PY{n}{x}\PY{p}{]} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{category\PYZus{}indices}\PY{p}{]}\PY{p}{,}
                                  \PY{n}{name} \PY{o}{=} \PY{n}{category}\PY{p}{,}
                                  \PY{n}{marker}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{size}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{n}{category\PYZus{}color}\PY{p}{)}\PY{p}{)}
         
             \PY{c+c1}{\PYZsh{} Append trace to data list}
             \PY{n}{data}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{trace}\PY{p}{)}
         
         \PY{n}{colored} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}} \PY{k}{if} \PY{n+nb}{str}\PY{p}{(}\PY{n}{color\PYZus{}by}\PY{p}{)} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{None}\PY{l+s+s1}{\PYZsq{}} \PY{k}{else} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Colored by }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{color\PYZus{}by}\PY{p}{)}
         \PY{n}{layout} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Layout}\PY{p}{(}\PY{n}{title}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZlt{}b\PYZgt{}PCA Analysis | Scatter Plot\PYZlt{}/b\PYZgt{}\PYZlt{}br\PYZgt{}\PYZlt{}i\PYZgt{}}\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s1}{\PYZlt{}/i\PYZgt{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{colored}\PY{p}{)}\PY{p}{,} \PY{n}{hovermode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{closest}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{margin}\PY{o}{=}\PY{n}{go}\PY{o}{.}\PY{n}{Margin}\PY{p}{(}\PY{n}{l}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{r}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{b}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{t}\PY{o}{=}\PY{l+m+mi}{50}\PY{p}{)}\PY{p}{,} \PY{n}{width}\PY{o}{=}\PY{l+m+mi}{900}\PY{p}{,}
             \PY{n}{scene}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{xaxis}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{title}\PY{o}{=}\PY{n}{var\PYZus{}explained}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{yaxis}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{title}\PY{o}{=}\PY{n}{var\PYZus{}explained}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{,}\PY{n}{zaxis}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{title}\PY{o}{=}\PY{n}{var\PYZus{}explained}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         \PY{n}{fig} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Figure}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{n}{data}\PY{p}{,} \PY{n}{layout}\PY{o}{=}\PY{n}{layout}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Plot}
         \PY{n}{iplot}\PY{p}{(}\PY{n}{fig}\PY{p}{)}
         \PY{n}{display}\PY{p}{(}\PY{n}{Markdown}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{** Figure 1 | Principal Component Analysis results. ** The figure displays an interactive, three\PYZhy{}dimensional scatter plot of the first three Principal Components (PCs) of the data. Each point represents an RNA\PYZhy{}seq sample. Samples with similar gene expression profiles are closer in the three\PYZhy{}dimensional space. If provided, sample groups are indicated using different colors, allowing for easier interpretation of the results.}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{o}{*}\PY{o}{*}\PY{n+nb}{locals}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    
    
    ** Figure 1 \textbar{} Principal Component Analysis results. ** The
figure displays an interactive, three-dimensional scatter plot of the
first three Principal Components (PCs) of the data. Each point
represents an RNA-seq sample. Samples with similar gene expression
profiles are closer in the three-dimensional space. If provided, sample
groups are indicated using different colors, allowing for easier
interpretation of the results.

    
    \subsection{Heatmap}\label{heatmap}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{k+kn}{import} \PY{n+nn}{requests}
         \PY{k+kn}{import} \PY{n+nn}{os}
         \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
         \PY{k+kn}{from} \PY{n+nn}{IPython}\PY{n+nn}{.}\PY{n+nn}{display} \PY{k}{import} \PY{n}{display}\PY{p}{,} \PY{n}{Markdown}\PY{p}{,} \PY{n}{IFrame}
         \PY{k+kn}{import} \PY{n+nn}{tempfile}
         
         \PY{c+c1}{\PYZsh{}def run(dataset, normalization=\PYZsq{}logCPM\PYZsq{}, z\PYZus{}score=True, nr\PYZus{}genes=1500, metadata\PYZus{}cols=None):}
         
         \PY{c+c1}{\PYZsh{} Get data}
         \PY{n}{data} \PY{o}{=} \PY{n}{dataset}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{logCPM}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Get tempfile}
         \PY{p}{(}\PY{n}{fd}\PY{p}{,} \PY{n}{filename}\PY{p}{)} \PY{o}{=} \PY{n}{tempfile}\PY{o}{.}\PY{n}{mkstemp}\PY{p}{(}\PY{p}{)}
         \PY{n}{filename} \PY{o}{=} \PY{n}{filename}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.txt}\PY{l+s+s1}{\PYZsq{}}
         \PY{k}{try}\PY{p}{:}
             \PY{c+c1}{\PYZsh{} Get variable subset}
             \PY{n}{data} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{data}\PY{o}{.}\PY{n}{var}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{1500}\PY{p}{]}\PY{p}{]}
         
             \PY{c+c1}{\PYZsh{} Z\PYZhy{}score}
             \PY{n}{data} \PY{o}{=} \PY{n}{data}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{n}{ss}\PY{o}{.}\PY{n}{zscore}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         
             \PY{c+c1}{\PYZsh{} Sample metadata}
             \PY{n}{sample\PYZus{}metadata} \PY{o}{=} \PY{n}{dataset}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sample\PYZus{}metadata}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
         
             \PY{c+c1}{\PYZsh{} For uploaded files}
             \PY{k}{if} \PY{n}{sample\PYZus{}metadata}\PY{o}{.}\PY{n}{index}\PY{o}{.}\PY{n}{name} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sample}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                 \PY{n}{sample\PYZus{}metadata} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{Series}\PY{p}{(}\PY{n}{index}\PY{o}{=}\PY{n}{sample\PYZus{}metadata}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{sample\PYZus{}metadata}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{name}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sample}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{to\PYZus{}frame}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{sample\PYZus{}metadata}\PY{p}{,} \PY{n}{left\PYZus{}index}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{right\PYZus{}index}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         
             \PY{c+c1}{\PYZsh{} Add metadata}
             \PY{n}{data}\PY{o}{.}\PY{n}{index} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Gene: }\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n}{x} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{data}\PY{o}{.}\PY{n}{index}\PY{p}{]}
             \PY{n}{data}\PY{o}{.}\PY{n}{columns}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{MultiIndex}\PY{o}{.}\PY{n}{from\PYZus{}tuples}\PY{p}{(}\PY{p}{[}\PY{n+nb}{tuple}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}key\PYZcb{}}\PY{l+s+s1}{: }\PY{l+s+si}{\PYZob{}value\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{o}{*}\PY{o}{*}\PY{n+nb}{locals}\PY{p}{(}\PY{p}{)}\PY{p}{)} \PY{k}{for} \PY{n}{key}\PY{p}{,} \PY{n}{value} \PY{o+ow}{in} \PY{n}{rowData}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{]}\PY{p}{)} \PY{k}{for} \PY{n}{index}\PY{p}{,} \PY{n}{rowData} \PY{o+ow}{in} \PY{n}{sample\PYZus{}metadata}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{data}\PY{o}{.}\PY{n}{columns}\PY{p}{]}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{]}\PY{p}{)}
         
             \PY{c+c1}{\PYZsh{} Write file and get link}
             \PY{n}{data}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{n}{filename}\PY{p}{,} \PY{n}{sep}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{clustergrammer\PYZus{}url} \PY{o}{=} \PY{n}{requests}\PY{o}{.}\PY{n}{post}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{http://amp.pharm.mssm.edu/clustergrammer/matrix\PYZus{}upload/}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{files}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{file}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n+nb}{open}\PY{p}{(}\PY{n}{filename}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{\PYZcb{}}\PY{p}{)}\PY{o}{.}\PY{n}{text}
         \PY{k}{finally}\PY{p}{:}
             \PY{n}{os}\PY{o}{.}\PY{n}{remove}\PY{p}{(}\PY{n}{filename}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Embed}
         \PY{n}{display}\PY{p}{(}\PY{n}{IFrame}\PY{p}{(}\PY{n}{clustergrammer\PYZus{}url}\PY{p}{,} \PY{n}{width}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1000}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{height}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1000}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Figure Legend}
         \PY{n}{display}\PY{p}{(}\PY{n}{Markdown}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{** Figure 2 | Clustergrammer analysis. **The figure contains an interactive heatmap displaying gene expression for each sample in the RNA\PYZhy{}seq dataset. Every row of the heatmap represents a gene, every column represents a sample, and every cell displays normalized gene expression values. The heatmap additionally features color bars beside each column which represent prior knowledge of each sample, such as the tissue of origin or experimental treatment.}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{o}{*}\PY{o}{*}\PY{n+nb}{locals}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    
    \begin{verbatim}
<IPython.lib.display.IFrame at 0x1e822738da0>
    \end{verbatim}

    
    ** Figure 2 \textbar{} Clustergrammer analysis. **The figure contains an
interactive heatmap displaying gene expression for each sample in the
RNA-seq dataset. Every row of the heatmap represents a gene, every
column represents a sample, and every cell displays normalized gene
expression values. The heatmap additionally features color bars beside
each column which represent prior knowledge of each sample, such as the
tissue of origin or experimental treatment.

    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{k+kn}{from} \PY{n+nn}{rpy2}\PY{n+nn}{.}\PY{n+nn}{robjects} \PY{k}{import} \PY{n}{r}\PY{p}{,} \PY{n}{pandas2ri}
         \PY{n}{pandas2ri}\PY{o}{.}\PY{n}{activate}\PY{p}{(}\PY{p}{)}
         \PY{n}{r}\PY{o}{.}\PY{n}{source}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./r/signature.R}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}  signatures[label] = generate\PYZus{}signature(group\PYZus{}A=groups[\PYZsq{}A\PYZsq{}], group\PYZus{}B=groups[\PYZsq{}B\PYZsq{}], method=\PYZsq{}limma\PYZsq{}, dataset=dataset)}
         
         \PY{k}{def} \PY{n+nf}{make\PYZus{}design\PYZus{}matrix}\PY{p}{(}\PY{n}{expression\PYZus{}dataframe}\PY{p}{,} \PY{n}{group\PYZus{}A}\PY{p}{,} \PY{n}{group\PYZus{}B}\PY{p}{,} \PY{n}{data}\PY{p}{)}\PY{p}{:}
             \PY{c+c1}{\PYZsh{} Sample names}
             \PY{n}{group\PYZus{}A} \PY{o}{=} \PY{p}{[}\PY{n}{x}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{group\PYZus{}A}\PY{p}{]}
             \PY{n}{group\PYZus{}B} \PY{o}{=} \PY{p}{[}\PY{n}{x}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{group\PYZus{}B}\PY{p}{]}
             \PY{n}{expression\PYZus{}dataframe}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{n}{x}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{expression\PYZus{}dataframe}\PY{o}{.}\PY{n}{columns}\PY{p}{]}
         
             \PY{c+c1}{\PYZsh{} Collapse duplicate genes}
             \PY{n}{expression\PYZus{}dataframe} \PY{o}{=} \PY{n}{expression\PYZus{}dataframe}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{index}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
         
             \PY{c+c1}{\PYZsh{} Get expression dataframe}
             \PY{k}{if} \PY{n}{data} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{subset}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                 \PY{n}{expression\PYZus{}dataframe} \PY{o}{=} \PY{n}{expression\PYZus{}dataframe}\PY{p}{[}\PY{n}{group\PYZus{}A}\PY{o}{+}\PY{n}{group\PYZus{}B}\PY{p}{]}
         
             \PY{c+c1}{\PYZsh{} Create design dataframe}
             \PY{n}{sample\PYZus{}dict} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{A}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{group\PYZus{}A}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{B}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{group\PYZus{}B}\PY{p}{\PYZcb{}}
             \PY{n}{design\PYZus{}dataframe} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{[}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{index}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{x}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{A}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n+nb}{int}\PY{p}{(}\PY{n}{x} \PY{o+ow}{in} \PY{n}{group\PYZus{}A}\PY{p}{)}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{B}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n+nb}{int}\PY{p}{(}\PY{n}{x} \PY{o+ow}{in} \PY{n}{group\PYZus{}B}\PY{p}{)}\PY{p}{\PYZcb{}} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{expression\PYZus{}dataframe}\PY{o}{.}\PY{n}{columns}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{index}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
             \PY{c+c1}{\PYZsh{} Return}
             \PY{k}{return} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{expression}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{expression\PYZus{}dataframe}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{design}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{design\PYZus{}dataframe}\PY{p}{\PYZcb{}}
             
         \PY{n}{processed\PYZus{}data} \PY{o}{=} \PY{n}{make\PYZus{}design\PYZus{}matrix}\PY{p}{(}\PY{n}{dataset}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rawdata}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{group\PYZus{}A}\PY{p}{,} \PY{n}{group\PYZus{}B}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{subset}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
             \PY{c+c1}{\PYZsh{} Add}
         \PY{n}{signature} \PY{o}{=} \PY{n}{pandas2ri}\PY{o}{.}\PY{n}{ri2py}\PY{p}{(}\PY{n}{r}\PY{o}{.}\PY{n}{limma}\PY{p}{(}\PY{n}{pandas2ri}\PY{o}{.}\PY{n}{py2ri}\PY{p}{(}\PY{n}{processed\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{expression}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{pandas2ri}\PY{o}{.}\PY{n}{py2ri}\PY{p}{(}\PY{n}{processed\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{design}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{logFC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gene\PYZus{}symbol}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}26}]:} \PY{n}{signature}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}26}]:}                 logFC   AveExpr          t       P.Value     adj.P.Val  \textbackslash{}
         gene\_symbol                                                              
         ELOVL3       9.683343  5.447817  46.711327  4.574667e-13  5.960905e-09   
         MFSD2A       9.555285  2.174115  22.657318  6.051491e-10  2.773799e-07   
         BMP8B        9.075953  0.847693  10.923314  6.866739e-07  2.241436e-05   
         PLA2G2E      8.990923 -1.004794  23.774497  3.764962e-10  2.042115e-07   
         ACOT5        8.534058 -1.166753  24.318061  3.011949e-10  1.849451e-07   
         
                              B  
         gene\_symbol             
         ELOVL3       19.770713  
         MFSD2A       13.239331  
         BMP8B         6.586395  
         PLA2G2E      11.809565  
         ACOT5        11.808750  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}36}]:} \PY{k}{def} \PY{n+nf}{plot\PYZus{}2D\PYZus{}scatter}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{text}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{title}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{xlab}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ylab}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{hoverinfo}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{black}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{colorscale}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Blues}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{l+m+mi}{8}\PY{p}{,} \PY{n}{showscale}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{symmetric\PYZus{}x}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{symmetric\PYZus{}y}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{pad}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{hline}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{vline}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{return\PYZus{}trace}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{labels}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{p}{:}
             \PY{n}{range\PYZus{}x} \PY{o}{=} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{n+nb}{max}\PY{p}{(}\PY{n+nb}{abs}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{pad}\PY{p}{,} \PY{n+nb}{max}\PY{p}{(}\PY{n+nb}{abs}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{p}{)}\PY{o}{+}\PY{n}{pad}\PY{p}{]}\PY{k}{if} \PY{n}{symmetric\PYZus{}x} \PY{k}{else} \PY{p}{[}\PY{p}{]}
             \PY{n}{range\PYZus{}y} \PY{o}{=} \PY{p}{[}\PY{o}{\PYZhy{}}\PY{n+nb}{max}\PY{p}{(}\PY{n+nb}{abs}\PY{p}{(}\PY{n}{y}\PY{p}{)}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{pad}\PY{p}{,} \PY{n+nb}{max}\PY{p}{(}\PY{n+nb}{abs}\PY{p}{(}\PY{n}{y}\PY{p}{)}\PY{p}{)}\PY{o}{+}\PY{n}{pad}\PY{p}{]}\PY{k}{if} \PY{n}{symmetric\PYZus{}y} \PY{k}{else} \PY{p}{[}\PY{p}{]}
             \PY{n}{trace} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Scattergl}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{n}{y}\PY{p}{,} \PY{n}{mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{markers}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{text}\PY{o}{=}\PY{n}{text}\PY{p}{,} \PY{n}{hoverinfo}\PY{o}{=}\PY{n}{hoverinfo}\PY{p}{,} \PY{n}{marker}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{color}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{color}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{colorscale}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{colorscale}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{showscale}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{showscale}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{size}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{size}\PY{p}{\PYZcb{}}\PY{p}{)}
             \PY{k}{if} \PY{n}{return\PYZus{}trace}\PY{p}{:}
                 \PY{k}{return} \PY{n}{trace}
             \PY{k}{else}\PY{p}{:}
                 \PY{n}{annotations} \PY{o}{=} \PY{p}{[}
                     \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{x}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mf}{0.25}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mf}{1.07}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZlt{}span style=}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{color: blue; font\PYZhy{}size: 10pt; font\PYZhy{}weight: 600;}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZgt{}Down\PYZhy{}regulated in }\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n}{labels}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZlt{}/span\PYZgt{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{showarrow}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{k+kc}{False}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xref}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{paper}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yref}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{paper}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xanchor}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{center}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,}
                     \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{x}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mf}{0.75}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mf}{1.07}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZlt{}span style=}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{color: red; font\PYZhy{}size: 10pt; font\PYZhy{}weight: 600;}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZgt{}Up\PYZhy{}regulated in }\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n}{labels}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZlt{}/span\PYZgt{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{showarrow}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{k+kc}{False}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xref}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{paper}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yref}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{paper}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xanchor}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{center}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}
                 \PY{p}{]} \PY{k}{if} \PY{n}{labels} \PY{k}{else} \PY{p}{[}\PY{p}{]}
                 \PY{n}{layout} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Layout}\PY{p}{(}\PY{n}{title}\PY{o}{=}\PY{n}{title}\PY{p}{,} \PY{n}{xaxis}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{xlab}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{range}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{range\PYZus{}x}\PY{p}{\PYZcb{}}\PY{p}{,} \PY{n}{yaxis}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{title}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{ylab}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{range}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{range\PYZus{}y}\PY{p}{\PYZcb{}}\PY{p}{,} \PY{n}{hovermode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{closest}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{annotations}\PY{o}{=}\PY{n}{annotations}\PY{p}{)}
                 \PY{n}{fig} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Figure}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{p}{[}\PY{n}{trace}\PY{p}{]}\PY{p}{,} \PY{n}{layout}\PY{o}{=}\PY{n}{layout}\PY{p}{)}
                 \PY{k}{return} \PY{n}{iplot}\PY{p}{(}\PY{n}{fig}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}37}]:} \PY{c+c1}{\PYZsh{} Volvano plot}
         \PY{c+c1}{\PYZsh{}results[\PYZsq{}volcano\PYZus{}plot\PYZsq{}][label] = analyze(signature=signature, tool=\PYZsq{}volcano\PYZus{}plot\PYZsq{}, signature\PYZus{}label=label, pvalue\PYZus{}threshold=0.05, logfc\PYZus{}threshold=1.5)}
         
         \PY{n}{pvalue\PYZus{}threshold}\PY{o}{=}\PY{l+m+mf}{0.05}
         \PY{n}{logfc\PYZus{}threshold}\PY{o}{=}\PY{l+m+mi}{2}
         
         \PY{c+c1}{\PYZsh{} Loop through signature}
         \PY{n}{color} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{text} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         
         \PY{k}{for} \PY{n}{index}\PY{p}{,} \PY{n}{rowData} \PY{o+ow}{in} \PY{n}{signature}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{:}
             \PY{c+c1}{\PYZsh{} Text}
             \PY{n}{text}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZlt{}b\PYZgt{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n}{index}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZlt{}/b\PYZgt{}\PYZlt{}br\PYZgt{}Avg Expression = }\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{n+nb}{round}\PY{p}{(}\PY{n}{rowData}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{AveExpr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{ndigits}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZlt{}br\PYZgt{}logFC = }\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{n+nb}{round}\PY{p}{(}\PY{n}{rowData}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{logFC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{ndigits}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZlt{}br\PYZgt{}p = }\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}:.2e\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{rowData}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{P.Value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZlt{}br\PYZgt{}FDR = }\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}:.2e\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{rowData}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{adj.P.Val}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         
             \PY{c+c1}{\PYZsh{} Color}
             \PY{k}{if} \PY{n}{rowData}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{P.Value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{n}{pvalue\PYZus{}threshold}\PY{p}{:}
             \PY{c+c1}{\PYZsh{} if rowData[\PYZsq{}adj.P.Val\PYZsq{}] \PYZlt{} 0.05:}
                 \PY{k}{if} \PY{n}{rowData}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{logFC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{o}{\PYZhy{}}\PY{n}{logfc\PYZus{}threshold}\PY{p}{:}
                     \PY{n}{color}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                 \PY{k}{elif} \PY{n}{rowData}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{logFC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{\PYZgt{}} \PY{n}{logfc\PYZus{}threshold}\PY{p}{:}
                     \PY{n}{color}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                 \PY{k}{else}\PY{p}{:}
                     \PY{n}{color}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{black}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
             \PY{k}{else}\PY{p}{:}
                 \PY{n}{color}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{black}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Return }
         \PY{n}{volcano\PYZus{}plot\PYZus{}results} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{x}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{signature}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{logFC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{log10}\PY{p}{(}\PY{n}{signature}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{P.Value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{text}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{color}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{color}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{signature\PYZus{}label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}
         
         \PY{c+c1}{\PYZsh{} Display results}
         \PY{n}{spacer} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{o}{*}\PY{l+m+mi}{50}
         \PY{n}{plot\PYZus{}2D\PYZus{}scatter}\PY{p}{(}
             \PY{n}{x}\PY{o}{=}\PY{n}{volcano\PYZus{}plot\PYZus{}results}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{x}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
             \PY{n}{y}\PY{o}{=}\PY{n}{volcano\PYZus{}plot\PYZus{}results}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
             \PY{n}{text}\PY{o}{=}\PY{n}{volcano\PYZus{}plot\PYZus{}results}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
             \PY{n}{color}\PY{o}{=}\PY{n}{volcano\PYZus{}plot\PYZus{}results}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{color}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
             \PY{n}{symmetric\PYZus{}x}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
             \PY{n}{xlab}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{logFC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{ylab}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log10P}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{title}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZlt{}b\PYZgt{}}\PY{l+s+si}{\PYZob{}volcano\PYZus{}plot\PYZus{}results[signature\PYZus{}label]\PYZcb{}}\PY{l+s+s1}{ Signature | Volcano Plot\PYZlt{}/b\PYZgt{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{o}{*}\PY{o}{*}\PY{n+nb}{locals}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{,}
             \PY{n}{labels}\PY{o}{=}\PY{n}{volcano\PYZus{}plot\PYZus{}results}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{signature\PYZus{}label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ vs }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{p}{)}
\end{Verbatim}


    
    
    \subsection{Genes incrementados}\label{genes-incrementados}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}42}]:} \PY{n}{upregulated\PYZus{}genes} \PY{o}{=} \PY{n}{signature}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{logFC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,}\PY{p}{)}
         \PY{n}{upregulated\PYZus{}genes}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}42}]:}                   logFC   AveExpr          t       P.Value     adj.P.Val  \textbackslash{}
         gene\_symbol                                                                
         ELOVL3         9.683343  5.447817  46.711327  4.574667e-13  5.960905e-09   
         MFSD2A         9.555285  2.174115  22.657318  6.051491e-10  2.773799e-07   
         BMP8B          9.075953  0.847693  10.923314  6.866739e-07  2.241436e-05   
         PLA2G2E        8.990923 -1.004794  23.774497  3.764962e-10  2.042115e-07   
         ACOT5          8.534058 -1.166753  24.318061  3.011949e-10  1.849451e-07   
         BDH1           8.398257  1.370721  11.217408  5.358935e-07  1.877300e-05   
         TACR2          8.313220 -0.248163  16.411133  1.419474e-08  1.667703e-06   
         KCNH6          7.758189  0.161838  20.883898  1.349164e-09  4.980636e-07   
         CYP2B10        7.661477  4.494948  20.126838  1.938379e-09  5.508843e-07   
         TTC22          7.640369 -1.636336  20.618660  1.529573e-09  5.165650e-07   
         PIGR           6.812043 -0.021869  17.390102  8.084346e-09  1.262554e-06   
         LRRC52         6.745069  0.439958  28.245397  6.846451e-11  7.853712e-08   
         CEND1          6.642041  2.258920  21.728844  9.135984e-10  3.811814e-07   
         FAM131C        6.302193  2.048549  17.243826  8.776896e-09  1.322386e-06   
         FGF21          6.181545 -1.036701   9.008402  4.023291e-06  8.103761e-05   
         SULT4A1        6.181437 -2.291470  14.756293  3.963933e-08  3.174690e-06   
         ARHGEF37       6.144600  2.065357  20.687965  1.480006e-09  5.149810e-07   
         1700011H14RIK  6.017553 -1.253429  10.374050  1.108333e-06  3.141949e-05   
         EPN3           5.846321 -0.433290   9.043209  3.885764e-06  7.913536e-05   
         ACOT12         5.807134  0.043576  17.062981  9.724541e-09  1.405331e-06   
         
                                B  
         gene\_symbol               
         ELOVL3         19.770713  
         MFSD2A         13.239331  
         BMP8B           6.586395  
         PLA2G2E        11.809565  
         ACOT5          11.808750  
         BDH1            6.833823  
         TACR2           9.833382  
         KCNH6          11.764897  
         CYP2B10        12.405517  
         TTC22          10.646135  
         PIGR           10.356000  
         LRRC52         13.862116  
         CEND1          12.906363  
         FAM131C        10.827069  
         FGF21           4.811317  
         SULT4A1         8.324904  
         ARHGEF37       12.438909  
         1700011H14RIK   5.957601  
         EPN3            4.876595  
         ACOT12         10.236325  
\end{Verbatim}
            
    \subsection{Genes disminuidos}\label{genes-disminuidos}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}44}]:} \PY{n}{downregulated\PYZus{}genes} \PY{o}{=} \PY{n}{signature}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{logFC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{downregulated\PYZus{}genes}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}44}]:}                  logFC   AveExpr          t       P.Value     adj.P.Val  \textbackslash{}
         gene\_symbol                                                               
         GM28439     -10.449762  0.207665  -4.277945  1.606331e-03  9.265587e-03   
         ANXA8        -6.863641  0.086994 -11.850483  3.201623e-07  1.287931e-05   
         FRAS1        -6.786019 -0.529615 -18.951396  3.494270e-09  7.530961e-07   
         SHISA9       -5.877109 -1.501929 -10.063171  1.467291e-06  3.875934e-05   
         NTRK3        -5.755850  5.648478 -29.458375  4.511708e-11  6.383870e-08   
         OTOF         -5.568534 -1.278975  -8.142570  9.908709e-06  1.586177e-04   
         RAB17        -5.543250 -0.456954 -13.044588  1.290194e-07  6.928579e-06   
         ACSM3        -5.132039  5.370435 -36.104400  5.970096e-12  2.428635e-08   
         RANBP3L      -5.073943 -1.869309  -8.260529  8.726538e-06  1.438685e-04   
         RPL14-PS1    -5.021637  0.040881  -2.533793  2.961841e-02  9.856478e-02   
         ACAT3        -5.000319  2.101230 -15.840845  1.999461e-08  2.065729e-06   
         EGR3         -4.921456 -0.240450 -10.635633  8.800555e-07  2.671691e-05   
         FER1L6       -4.841476 -0.158417  -4.313906  1.517793e-03  8.874427e-03   
         GM13461      -4.809769 -1.157532  -4.195201  1.831388e-03  1.032941e-02   
         GM8126       -4.789223 -1.993330  -7.232267  2.774736e-05  3.493269e-04   
         FOSB         -4.724956 -0.018512  -7.050719  3.445260e-05  4.149259e-04   
         GM5798       -4.580311 -2.114555  -7.049175  3.451663e-05  4.151180e-04   
         ECI3         -4.499301  0.949119 -10.977225  6.558850e-07  2.160438e-05   
         EGR1         -4.412795  4.738701  -6.634472  5.744132e-05  6.179736e-04   
         GM14685      -4.339975 -1.561809  -5.116788  4.488103e-04  3.246517e-03   
         
                              B  
         gene\_symbol             
         GM28439      -1.195252  
         ANXA8         7.253200  
         FRAS1        10.742904  
         SHISA9        5.677787  
         NTRK3        16.013852  
         OTOF          3.955829  
         RAB17         7.966197  
         ACSM3        17.762568  
         RANBP3L       4.041514  
         RPL14-PS1    -4.086938  
         ACAT3        10.056511  
         EGR3          6.286016  
         FER1L6       -1.088148  
         GM13461      -1.164627  
         GM8126        2.963283  
         FOSB          2.731989  
         GM5798        2.754953  
         ECI3          6.633143  
         EGR1          1.661958  
         GM14685       0.264795  
\end{Verbatim}
            

    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
